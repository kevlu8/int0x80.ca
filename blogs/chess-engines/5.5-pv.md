---
title: "5.5 - PV"
slug: pv
description: "The PV flag"
date: 2025-09-27
---

# PV
### 2025-09-27

From here on out, we will be implementing a lot of pruning heuristics that will massively speed up our search. However, we cannot do aggressive pruning on every node, since we might end up pruning the best move.

In general, our final search score is only defined by the principal variation (the best line of play). So, we need to be very careful when searching nodes we suspect to be part of the principal variation. These nodes are called *PV-nodes*.

## The PV flag

We can simply add a flag to our search that dictates whether or not we suspect we are in a PV node. This flag is true if we are searching the first move of a node that is itself a PV-node, and false otherwise.

```cpp
Value negamax(Board& board, int depth, Value alpha, Value beta, bool pv) {
	...
	while ((m = next_move(scores)) != NullMove) {
		board.make_move(m);
		Value score = 0;
		if (!m_idx && pv) { // First move of a PV node
			score = -negamax(board, depth - 1, -beta, -alpha, true);
		} else {
			score = -negamax(board, depth - 1, -beta, -alpha, false);
		}
		board.unmake_move();
		...
	}
	...
}
```

Naturally, the root node is always a PV-node, so we call our search with `pv = true`.

We're all set to implement more complex pruning heuristics now that we have the PV flag!
